require 'spec_helper.rb'

describe command('rpm -qa bash') do
  its(:stdout) { should match(
    /(bash-4\.1\.2-15\.el6_4\.1|bash-4\.1\.2-9\.el6_2\.1|bash-3\.2-32\.el5_9\.2|bash-3\.2-24\.el5_6\.1|bash-3\.0-27\.el4\.2|bash-4\.2\.45-5\.el7_0\.2|bash-4\.1\.2-15\.el6_5\.1|bash-3\.2-33\.el5\.1)/
  )}
end

describe command("env x='() { :;}; echo vulnerable' bash -c 'echo this is a test'") do
  its(:stdout) { should_not match(
    /vulnerable/
  )}
end
